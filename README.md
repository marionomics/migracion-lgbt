# migracion-lgbt

In this project we explore the hypothesis that discrimination against LGBT+ people is a cause of internal migration in Mexico.

En este proyecto exploramos la discriminacion a las personas LGBT como causa de la migracion interna en Mexico.
## Project Structure

```
migracion-lgbt/
├── analysis/              # R analysis scripts (run in order)
│   ├── 01_endiseg.R       # ENDISEG 2021 survey analysis
│   ├── 02_gold_standard.R # Gold-standard prevalence estimates
│   ├── 03_did2x2.R        # 2x2 difference-in-differences
│   ├── 04_struc_change.R  # Structural break analysis
│   └── 05_staggered_did.R # Staggered DiD with fixed effects
│
├── scripts/               # Python data pipeline (run in order)
│   ├── 01_download_ENOE.py    # Download ENOE microdata
│   ├── 02_create_dataset.py   # Build analysis dataset
│   ├── 03_plot_migration.py   # Migration trend plots
│   ├── 04_timeline.py         # Policy timeline figure
│   └── 05_time_map.py         # Geographic visualization
│
├── r/                     # R utility functions
├── auxiliary/             # Reference tables (equal marriage dates, etc.)
├── data/                  # All data (gitignored, generated by pipeline)
├── notebooks/             # Exploratory Jupyter notebooks
├── tables/                # Output tables
├── img/                   # Output figures
├── paper/                 # Manuscript files
├── archive/               # Superseded scripts (see archive/README.md)
├── Notes/                 # Research notes
└── public/                # Public-facing materials
```

## Data Sources

- **ENOE** (Encuesta Nacional de Ocupacion y Empleo), 2017--2022, INEGI
- **ENDISEG** (Encuesta Nacional sobre Diversidad Sexual y de Genero), 2021, INEGI

## Replication

### Prerequisites

**Python** (3.8+):
```bash
pip install -r requirements.txt
```

**R** packages:
```r
install.packages(c("tidyverse", "survey", "scales", "ggthemes",
                    "strucchange", "fixest", "bacondecomp", "haven", "lfe"))
```

### Steps

1. **Download data** (Python): run `scripts/01_download_ENOE.py` from the project root. This populates `data/`.
2. **Build dataset** (Python): run `scripts/02_create_dataset.py` to produce `data/ENOE/final/lgbt_migration.csv`.
3. **R analysis**: open `migracion-lgbt.Rproj` in RStudio and run scripts in `analysis/` in numbered order (01 through 05).
4. **Figures** (Python): run `scripts/03_plot_migration.py`, `04_timeline.py`, and `05_time_map.py` for Python-generated plots. R scripts in `analysis/` also produce figures saved to `img/`.

## License

See [LICENSE](LICENSE).
